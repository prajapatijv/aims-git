VERSION 5.00
Object = "{0ECD9B60-23AA-11D0-B351-00A0C9055D8E}#6.0#0"; "MSHFLXGD.OCX"
Begin VB.Form frmPosGui 
   BorderStyle     =   0  'None
   ClientHeight    =   9735
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   14910
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   13.5
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   ScaleHeight     =   9735
   ScaleWidth      =   14910
   ShowInTaskbar   =   0   'False
   Begin VB.Frame Frame2 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   6495
      Left            =   5415
      TabIndex        =   1
      Top             =   120
      Width           =   7935
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   19
         Left            =   6360
         Style           =   1  'Graphical
         TabIndex        =   23
         TabStop         =   0   'False
         Top             =   4920
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   18
         Left            =   4800
         Style           =   1  'Graphical
         TabIndex        =   22
         TabStop         =   0   'False
         Top             =   4920
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   17
         Left            =   3240
         Style           =   1  'Graphical
         TabIndex        =   21
         TabStop         =   0   'False
         Top             =   4920
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   16
         Left            =   1680
         Style           =   1  'Graphical
         TabIndex        =   20
         TabStop         =   0   'False
         Top             =   4920
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   15
         Left            =   120
         Style           =   1  'Graphical
         TabIndex        =   19
         TabStop         =   0   'False
         Top             =   4920
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   14
         Left            =   6360
         Style           =   1  'Graphical
         TabIndex        =   18
         TabStop         =   0   'False
         Top             =   3360
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   13
         Left            =   4800
         Style           =   1  'Graphical
         TabIndex        =   17
         TabStop         =   0   'False
         Top             =   3360
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   12
         Left            =   3240
         Style           =   1  'Graphical
         TabIndex        =   16
         TabStop         =   0   'False
         Top             =   3360
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   11
         Left            =   1680
         Style           =   1  'Graphical
         TabIndex        =   15
         TabStop         =   0   'False
         Top             =   3360
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   10
         Left            =   120
         Style           =   1  'Graphical
         TabIndex        =   14
         TabStop         =   0   'False
         Top             =   3360
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   9
         Left            =   6360
         Style           =   1  'Graphical
         TabIndex        =   13
         TabStop         =   0   'False
         Top             =   1800
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   8
         Left            =   4800
         Style           =   1  'Graphical
         TabIndex        =   12
         TabStop         =   0   'False
         Top             =   1800
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   7
         Left            =   3240
         Style           =   1  'Graphical
         TabIndex        =   11
         TabStop         =   0   'False
         Top             =   1800
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   6
         Left            =   1680
         Style           =   1  'Graphical
         TabIndex        =   10
         TabStop         =   0   'False
         Top             =   1800
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   5
         Left            =   120
         Style           =   1  'Graphical
         TabIndex        =   9
         TabStop         =   0   'False
         Top             =   1800
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   4
         Left            =   6360
         Style           =   1  'Graphical
         TabIndex        =   8
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   3
         Left            =   4800
         Style           =   1  'Graphical
         TabIndex        =   7
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   2
         Left            =   3240
         Style           =   1  'Graphical
         TabIndex        =   6
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   1
         Left            =   1680
         Style           =   1  'Graphical
         TabIndex        =   5
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
      Begin VB.CommandButton cmdItems 
         Caption         =   "cmdItem"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1400
         Index           =   0
         Left            =   120
         Style           =   1  'Graphical
         TabIndex        =   4
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
   End
   Begin VB.Frame Frame1 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   5415
      Left            =   120
      TabIndex        =   0
      Top             =   120
      Width           =   5295
      Begin MSHierarchicalFlexGridLib.MSHFlexGrid mshTicket 
         Height          =   4575
         Left            =   120
         TabIndex        =   36
         Top             =   720
         Width           =   5055
         _ExtentX        =   8916
         _ExtentY        =   8070
         _Version        =   393216
         ForeColor       =   8388608
         Rows            =   1
         Cols            =   1
         FixedRows       =   0
         FixedCols       =   0
         ForeColorFixed  =   8388608
         BackColorSel    =   16308668
         ForeColorSel    =   8388608
         BackColorBkg    =   14482428
         FocusRect       =   0
         SelectionMode   =   1
         Appearance      =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty FontFixed {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         _NumberOfBands  =   1
         _Band(0).Cols   =   1
      End
      Begin MSHierarchicalFlexGridLib.MSHFlexGrid mshHeader 
         Height          =   615
         Left            =   120
         TabIndex        =   37
         Top             =   240
         Width           =   5055
         _ExtentX        =   8916
         _ExtentY        =   1085
         _Version        =   393216
         ForeColor       =   8388608
         Cols            =   1
         FixedCols       =   0
         ForeColorFixed  =   8388608
         BackColorSel    =   16308668
         ForeColorSel    =   8388608
         BackColorBkg    =   14482428
         FocusRect       =   0
         SelectionMode   =   1
         Appearance      =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty FontFixed {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         _NumberOfBands  =   1
         _Band(0).Cols   =   1
      End
   End
   Begin VB.Frame Frame5 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Left            =   120
      TabIndex        =   29
      Top             =   5445
      Width           =   5295
      Begin VB.TextBox txtTotalAmount 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H8000000B&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C00000&
         Height          =   420
         Left            =   3960
         Locked          =   -1  'True
         TabIndex        =   31
         TabStop         =   0   'False
         Top             =   200
         Width           =   1215
      End
      Begin VB.TextBox txtTotalQty 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H8000000B&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C00000&
         Height          =   420
         Left            =   2880
         Locked          =   -1  'True
         TabIndex        =   30
         TabStop         =   0   'False
         Top             =   200
         Width           =   975
      End
   End
   Begin VB.Frame Frame6 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1095
      Left            =   120
      TabIndex        =   32
      Top             =   6090
      Width           =   5295
      Begin VB.CommandButton cmdPay 
         Caption         =   "0.00"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   735
         Left            =   120
         TabIndex        =   33
         TabStop         =   0   'False
         Top             =   240
         Width           =   5055
      End
   End
   Begin VB.Frame Frame7 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   2490
      Left            =   120
      TabIndex        =   34
      Top             =   7095
      Width           =   5295
      Begin VB.Label lblChangeAmount 
         Alignment       =   2  'Center
         Caption         =   "Change Amount"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000040C0&
         Height          =   1155
         Left            =   240
         TabIndex        =   39
         Top             =   360
         Width           =   4815
      End
   End
   Begin VB.Frame Frame8 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   6495
      Left            =   13350
      TabIndex        =   38
      Top             =   120
      Width           =   1425
      Begin VB.CommandButton cmdItemNevigate 
         Caption         =   ">"
         Height          =   1275
         Index           =   1
         Left            =   120
         Style           =   1  'Graphical
         TabIndex        =   43
         TabStop         =   0   'False
         Top             =   5040
         Width           =   1215
      End
      Begin VB.CommandButton cmdItemNevigate 
         Caption         =   "<"
         Height          =   1400
         Index           =   0
         Left            =   720
         Style           =   1  'Graphical
         TabIndex        =   42
         TabStop         =   0   'False
         Top             =   3360
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.CommandButton cmdPrint 
         Caption         =   "E&xit"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   120
         TabIndex        =   41
         TabStop         =   0   'False
         Top             =   210
         Width           =   1215
      End
   End
   Begin VB.Frame Frame3 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1575
      Left            =   5415
      TabIndex        =   2
      Top             =   6525
      Width           =   9360
      Begin VB.CommandButton cmdCategoryNeviagte 
         Caption         =   ">"
         Height          =   1200
         Index           =   0
         Left            =   7920
         Style           =   1  'Graphical
         TabIndex        =   44
         TabStop         =   0   'False
         Top             =   240
         Width           =   1335
      End
      Begin VB.CommandButton cmdCategory 
         Caption         =   "cmdCategory"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Index           =   4
         Left            =   6360
         Style           =   1  'Graphical
         TabIndex        =   28
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
      Begin VB.CommandButton cmdCategory 
         Caption         =   "cmdCategory"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Index           =   3
         Left            =   4800
         Style           =   1  'Graphical
         TabIndex        =   27
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
      Begin VB.CommandButton cmdCategory 
         Caption         =   "cmdCategory"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Index           =   2
         Left            =   3240
         Style           =   1  'Graphical
         TabIndex        =   26
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
      Begin VB.CommandButton cmdCategory 
         Caption         =   "cmdCategory"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Index           =   1
         Left            =   1680
         Style           =   1  'Graphical
         TabIndex        =   25
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
      Begin VB.CommandButton cmdCategory 
         Caption         =   "cmdCategory"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Index           =   0
         Left            =   120
         Style           =   1  'Graphical
         TabIndex        =   24
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
   End
   Begin VB.Frame Frame4 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1575
      Left            =   5415
      TabIndex        =   3
      Top             =   8010
      Width           =   9360
      Begin VB.CommandButton cmdQty 
         Caption         =   "Quantity"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Left            =   6360
         TabIndex        =   47
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   1400
      End
      Begin VB.CommandButton cmdNoStock 
         Caption         =   "No Stock"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Left            =   4800
         TabIndex        =   46
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   1400
      End
      Begin VB.CommandButton cmdSerchItem 
         Caption         =   "Search Item"
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Left            =   3240
         TabIndex        =   45
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   1400
      End
      Begin VB.CommandButton cmdVoidTicket 
         Caption         =   "Void Ticket"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Left            =   1680
         TabIndex        =   40
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
      Begin VB.CommandButton cmdVoidItem 
         Caption         =   "Void Item"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1200
         Left            =   120
         TabIndex        =   35
         TabStop         =   0   'False
         Top             =   240
         Width           =   1400
      End
   End
   Begin VB.Shape Shape1 
      BorderColor     =   &H00C00000&
      BorderWidth     =   3
      Height          =   240
      Left            =   0
      Top             =   0
      Width           =   210
   End
End
Attribute VB_Name = "frmPosGui"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim rs_TicItms As ADODB.Recordset
Dim rs_ItmsLst As ADODB.Recordset
Dim rs_ItmCat As ADODB.Recordset

Dim mTerminalId  As Integer
Dim mdTicketDenom As Double

Private Enum enmColTicket
    eItmId = 0
    eItmDescr = 1
    eItmQty = 2
    eItmamt = 3
    eItmRtlPrc = 4
    eItmDistAmt = 5
End Enum

Private Enum enmEntry
    eInsert = 1
    eUpdate = 2
End Enum


Private Sub SetMshTickets()

    'Set Header Grid------------------------------------------------------------------
    With mshHeader
        .RowHeight(0) = 500
        .Height = 1000
        .Cols = 6
        .ScrollBars = flexScrollBarBoth
        .Enabled = False
        
        .ColWidth(0) = 0
        .ColWidth(1) = 2600
        .ColWidth(2) = 500: .ColAlignment(2) = flexAlignRightCenter
        .ColWidth(3) = 1100: .ColAlignment(3) = flexAlignRightCenter
        .ColWidth(4) = 1100
        .ColWidth(5) = 1100
        
        .TextMatrix(0, enmColTicket.eItmId) = "ITM_ID"      'Not visible
        .TextMatrix(0, enmColTicket.eItmDescr) = "Item Description"
        .TextMatrix(0, enmColTicket.eItmQty) = "Qty"
        .TextMatrix(0, enmColTicket.eItmamt) = "Amount"
        .TextMatrix(0, enmColTicket.eItmRtlPrc) = "Item Price"
        .TextMatrix(0, enmColTicket.eItmDistAmt) = "Discount"
    End With
    '---------------------------------------------------------------------------------
    
    'Set Ticket Grid------------------------------------------------------------------
    With mshTicket
        .FixedCols = 0
        .GridLinesFixed = flexGridInset
        .GridLines = flexGridFlat
        .FocusRect = flexFocusLight
        .HighLight = flexHighlightWithFocus
        .RowHeightMin = 300
        .ScrollBars = flexScrollBarBoth
        
        .Cols = 6
        .ColWidth(0) = 0
        .ColWidth(1) = 2600
        .ColWidth(2) = 500: .ColAlignment(2) = flexAlignRightCenter
        .ColWidth(3) = 1100: .ColAlignment(3) = flexAlignRightCenter
        
        .ColWidth(4) = 1100: .ColAlignment(4) = flexAlignRightCenter
        .ColWidth(5) = 1100: .ColAlignment(5) = flexAlignRightCenter
         
        .Move mshHeader.Left, mshHeader.Top + mshHeader.RowHeight(0)
    End With
    '---------------------------------------------------------------------------------
End Sub

Private Sub cmdCategory_Click(Index As Integer)
    
    SetItemListbyCategory Val(cmdCategory(Index).Tag)
    PopulateItemBtns 1

    Dim iCnt As Integer
    For iCnt = 0 To cmdCategory.Count - 1
        cmdCategory(iCnt).FontBold = False
    Next
    cmdCategory(Index).FontBold = True

End Sub

Private Sub cmdCategoryNeviagte_Click(Index As Integer)
    
    PopulateCategoryBtns rs_ItmCat.AbsolutePage
    
End Sub

Private Sub cmdItemNevigate_Click(Index As Integer)
    
    Select Case Index
        Case 0
            If rs_ItmsLst.AbsolutePage > 2 Then
                PopulateItemBtns rs_ItmsLst.AbsolutePage - 2
            End If
        Case 1
            PopulateItemBtns rs_ItmsLst.AbsolutePage
    End Select
    
End Sub

Private Sub cmdItems_Click(Index As Integer)

    AddItem2Ticket SplitItemDetails(cmdItems.Item(Index).Tag, 0), _
                    cmdItems.Item(Index).Caption, _
                    SplitItemDetails(cmdItems.Item(Index).Tag, 1), _
                    SplitItemDetails(cmdItems.Item(Index).Tag, 2)
    
    
    Dim iCnt As Integer
    For iCnt = 0 To cmdItems.Count - 1
        cmdItems(iCnt).FontBold = False
    Next
    cmdItems(Index).FontBold = True
    
End Sub

Private Sub cmdPay_Click()

    Dim mbtnOkPressed As Boolean
    mbtnOkPressed = False
    If Val(cmdPay.Caption) = 0 Then
        Exit Sub
    End If
    
    With frmDenoms
        mdTicketDenom = .Display(Val(cmdPay.Caption), mbtnOkPressed)
    End With
    
    If mbtnOkPressed Then
        SaveSales
    End If
    
    If mdTicketDenom = 0 Then Exit Sub
    
    lblChangeAmount.Caption = "Change Amount " & vbCrLf & _
                Format$(mdTicketDenom - Val(cmdPay.Caption), "###0.00")
                
    
    Prepare4NewTiceket
    
End Sub

Private Sub cmdPrint_Click()

    Unload Me
    
End Sub

Private Sub cmdVoidItem_Click()
    
    RemoveItem
    
End Sub

Private Sub cmdVoidTicket_Click()

    Prepare4NewTiceket
    
End Sub

Private Sub Form_Load()

    CenterFrmChild Me

    SetMshTickets
    
    SetControls
    
    RebindTicketGrid

End Sub

Private Sub AddItem2Ticket(s_iItmId As Long, s_sItmDescr As String, s_dUnitPrice As Double, s_dDiscAmt As Double)
        
    Dim mItemExist As Boolean
    
    lblChangeAmount.Caption = ""
    
    With rs_TicItms
        mItemExist = IsItemExists(s_iItmId)

        If Not mItemExist Then
            .AddNew
        End If
        
        .Fields("itm_id").Value = Val(s_iItmId)
        .Fields("shortname") = Trim$(s_sItmDescr)
        .Fields("qty") = Val(.Fields("qty")) + 1
        .Fields("rtl_amt") = Format$(Val(s_dUnitPrice - Val(s_dDiscAmt)) * Val(.Fields("qty")), "###.00")
        .Fields("rtl_prc") = Format$(Val(s_dUnitPrice), "###.00")
        .Fields("disc_amt") = Format$(Val(s_dDiscAmt) * Val(.Fields("qty")), "###.00")
        .Update
    End With
    
    RebindTicketGrid
    
End Sub

Private Function IsItemExists(s_iItmId As Long) As Boolean
    
    Dim i As Integer
    
    IsItemExists = False

    With rs_TicItms
        If .State = adStateClosed Then .Open
        If (.RecordCount <= 0) Then
            Exit Function
        End If
        
        .MoveFirst
        
        While Not .EOF
            If Val(.Fields("itm_id").Value) = Val(s_iItmId) Then
                IsItemExists = True
                Exit Function
            End If
            .MoveNext
        Wend
    End With
    
End Function

Private Sub TicketTotal()

    Dim i As Integer
    Dim iQty As Integer
    Dim dTicketAmt As Double
    iQty = 0
    dTicketAmt = 0
    
    With mshTicket
        For i = 0 To .Rows - 1
            iQty = iQty + Val(.TextMatrix(i, enmColTicket.eItmQty))
            dTicketAmt = dTicketAmt + Val(.TextMatrix(i, enmColTicket.eItmamt))
        Next
    End With
            
    txtTotalQty.Text = iQty
    txtTotalAmount.Text = Format$(dTicketAmt, "###.00")
    cmdPay.Caption = txtTotalAmount.Text
End Sub

Private Sub SetControls()
    
    Set rs_TicItms = New ADODB.Recordset
    Set rs_ItmsLst = New ADODB.Recordset
    Set rs_ItmCat = New ADODB.Recordset

    'Set Terminal Id from INT file-----------------------------------
    mTerminalId = gTerminalId

    'Load Categories--------------------------------------------------
    SQL = "Exec stpFetchItemCategory "
    OpenAdoRst rs_ItmCat, SQL, adOpenKeyset, , , gCnnMst
    PopulateCategoryBtns 1

    'Load Items-------------------------------------------------------
    SetItemListbyCategory Val(cmdCategory(0).Tag)
    PopulateItemBtns 1

    cmdCategory_Click (0)

    With rs_TicItms
        .CursorLocation = adUseClient
        .CursorType = adOpenStatic
        
        .Fields.Append "itm_id", adVarChar, 10
        .Fields.Append "shortname", adVarChar, 35
        .Fields.Append "qty", adVarChar, 5
        .Fields.Append "rtl_amt", adVarChar, 12
        .Fields.Append "rtl_prc", adVarChar, 12
        .Fields.Append "disc_amt", adVarChar, 12
    End With

    With mshHeader
        txtTotalQty.Width = .ColWidth(enmColTicket.eItmQty) + 10
        txtTotalAmount.Width = .ColWidth(enmColTicket.eItmamt) - 200
        
        txtTotalQty.Left = .Left + .ColPos(enmColTicket.eItmQty)
        txtTotalAmount.Left = .Left + .ColPos(enmColTicket.eItmamt)
    End With
    
    lblChangeAmount.Caption = ""
    cmdItemNevigate(1).Caption = " >>"
    
End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
    Set rs_TicItms = Nothing
    Set rs_ItmsLst = Nothing
    Set rs_ItmCat = Nothing
End Sub

Private Sub RebindTicketGrid()
    
On Error GoTo errorhandler

    With mshTicket
        .Redraw = False
        
        Set .Recordset = rs_TicItms
        SetMshTickets
        
        SetGridColGujFont mshTicket, enmColTicket.eItmDescr
        
        .Redraw = True
        
        cmdVoidItem.Enabled = (.Rows > 0)
        cmdVoidTicket.Enabled = (.Rows > 0)
        cmdPay.Enabled = (.Rows > 0)
    End With

    TicketTotal
    
    'SetGridRowColor mshTicket, mGridTicketBookMark - 1, vbCyan
    
errorhandler:
    
    Select Case Err.Number
        Case -2147217885        'Delete mode
            Resume Next
    End Select

End Sub

Private Sub RemoveItem()

    Dim mItemId As Long
    If mshTicket.Rows > 0 Then
        mItemId = Val(mshTicket.TextMatrix(mshTicket.Row, enmColTicket.eItmId))
        
        With rs_TicItms
            If IsItemExists(mItemId) Then
                .Fields("qty").Value = Val(.Fields("qty").Value) - 1
                .Update
                If .Fields("qty").Value = 0 Then
                    .Delete adAffectCurrent
                    .Update
                End If
            End If
        End With
    
    End If
    
    RebindTicketGrid
End Sub

Private Sub Prepare4NewTiceket()
    
    With rs_TicItms
        .MoveFirst
        While Not .EOF
            .Delete adAffectCurrent
            .Update
            .MoveNext
        Wend
    End With
    
    RebindTicketGrid
    
End Sub

Private Sub PopulateItemBtns(s_iPage As Integer)

    Dim iCnt As Integer
    Const PAGE_SIZE As Integer = 20
    
    For iCnt = 0 To PAGE_SIZE - 1
        cmdItems(iCnt).Visible = False
    Next

    If s_iPage <= 0 Then Exit Sub

    If rs_ItmsLst.RecordCount <= 0 Then
        Exit Sub
    End If


    With rs_ItmsLst
        cmdItemNevigate(1).Caption = Val(.AbsolutePage) & " >>"
        .PageSize = PAGE_SIZE
        .AbsolutePage = s_iPage
        For iCnt = 0 To .PageSize - 1
        
            cmdItems(iCnt).FontName = gGujaratiFontName
            cmdItems(iCnt).FontSize = 12
            cmdItems(iCnt).FontBold = False

            If .EOF = True Then
                cmdItems(iCnt).Visible = False
            Else
                If Trim$(.Fields("sizename").Value) = "<unknown>" Then
                    'ShortNmae
                    cmdItems(iCnt).Caption = .Fields("shortname").Value
                Else
                    'Shortname + Size
                    cmdItems(iCnt).Caption = .Fields("shortname").Value & "(" & Trim$(.Fields("sizename").Value) & ")"
                End If
                'Itm_Code ~ Rtl_Prc ~ Disc_Amt
                cmdItems(iCnt).Tag = .Fields("itm_code").Value & _
                                    "~" & Format(.Fields("rtl_prc").Value, "###0.00") & _
                                    "~" & Format(.Fields("disc_amt").Value, "###0.00")
                                    
                cmdItems(iCnt).Visible = True
                .MoveNext
            End If
        Next
        If .AbsolutePage = adPosEOF Then
            .MoveFirst
        End If
    End With
End Sub

Private Sub PopulateCategoryBtns(s_iPage As Integer)

    Dim iCnt As Integer
    Const CAT_PAGE_SIZE As Integer = 5
    
    For iCnt = 0 To CAT_PAGE_SIZE - 1
        cmdCategory(iCnt).Visible = False
    Next
    
    If s_iPage <= 0 Then Exit Sub
    
    If rs_ItmCat.RecordCount <= 0 Then
        Exit Sub
    End If


    With rs_ItmCat
        .PageSize = CAT_PAGE_SIZE
        .AbsolutePage = s_iPage
        For iCnt = 0 To .PageSize - 1
            cmdCategory(iCnt).FontName = gGujaratiFontName
            cmdCategory(iCnt).FontSize = 12
            cmdCategory(iCnt).FontBold = False
            
            If .EOF = True Then
                cmdCategory(iCnt).Visible = False
            Else
                cmdCategory(iCnt).Caption = .Fields("shortname").Value
                cmdCategory(iCnt).Tag = .Fields("code").Value
                cmdCategory(iCnt).Visible = True
                .MoveNext
            End If
        Next
        If .AbsolutePage = adPosEOF Then
            .MoveFirst
        End If
    End With
End Sub

Private Function SplitItemDetails(s_sItemDetails As String, s_iItemIndex As Integer)
    
    Dim temp
    temp = Split(s_sItemDetails, "~")
    
    If UBound(temp) >= s_iItemIndex Then
        SplitItemDetails = temp(s_iItemIndex)
    Else
        SplitItemDetails = ""
    End If
    
End Function

Private Sub Form_Resize()
    With Shape1
        .BorderWidth = 5
        .Move 0, 0, Me.Width, Me.Height
    End With
End Sub

Private Sub SetItemListbyCategory(s_iCategoryId As Integer)
        
    SQL = "Exec stpItemKeybrdList " & s_iCategoryId
    OpenAdoRst rs_ItmsLst, SQL, adOpenKeyset, , , gCnnMst

End Sub

Private Function SQLSaveTrn(s_EntryId As String) As String
On Error GoTo errhndl
MP vbHourglass
        
    Dim sSQL As String
    
    sSQL = "IF NOT EXISTS (" & vbCrLf
    sSQL = sSQL & "     SELECT '1' " & vbCrLf
    sSQL = sSQL & "     FROM TerSaltrn " & vbCrLf
    sSQL = sSQL & "     WHERE tran_id = " & AQ(s_EntryId) & vbCrLf
    sSQL = sSQL & "     )" & vbCrLf
    
    sSQL = sSQL & " BEGIN " & vbCrLf
    sSQL = sSQL & "     Insert into TerSaltrn(" & vbCrLf
    sSQL = sSQL & "          tran_id" & vbCrLf
    sSQL = sSQL & "         ,ter_id" & vbCrLf
    sSQL = sSQL & "         ,export_fg" & vbCrLf
    
    sSQL = sSQL & "         ,paid_amt" & vbCrLf
    sSQL = sSQL & "         ,change_amt" & vbCrLf
    
    sSQL = sSQL & "         ,dtadat" & vbCrLf
    sSQL = sSQL & "         ,dtatim" & vbCrLf
    sSQL = sSQL & "         ,dtausr" & vbCrLf
    
    sSQL = sSQL & " ) Values (" & vbCrLf
    
    sSQL = sSQL & "          " & AQ(s_EntryId) & vbCrLf
    sSQL = sSQL & "         ," & mTerminalId & vbCrLf
    sSQL = sSQL & "         ," & "0" & vbCrLf       'False
    
    sSQL = sSQL & "         ," & Val(txtTotalAmount.Text) & vbCrLf
    sSQL = sSQL & "         ," & mdTicketDenom - Val(cmdPay.Caption) & vbCrLf
    
    sSQL = sSQL & "         ," & ConvDatSql(Date) & vbCrLf
    sSQL = sSQL & "         ," & AQ(DtaTime) & vbCrLf
    sSQL = sSQL & "         ," & AQ(gUser) & vbCrLf
    sSQL = sSQL & ")"
    sSQL = sSQL & " END " & vbCrLf
    
    sSQL = sSQL & " ELSE " & vbCrLf
    
    sSQL = sSQL & " BEGIN " & vbCrLf
    sSQL = sSQL & "     Update TerSaltrn" & vbCrLf
    sSQL = sSQL & "     Set  tran_id    = " & AQ(s_EntryId) & vbCrLf
    sSQL = sSQL & "         ,ter_id     = " & mTerminalId & vbCrLf
    sSQL = sSQL & "         ,export_fg  = " & "0" & vbCrLf   'False
    
    sSQL = sSQL & "         ,dtadat     = " & ConvDatSql(Date) & vbCrLf
    sSQL = sSQL & "         ,dtatim     = " & AQ(DtaTime) & vbCrLf
    sSQL = sSQL & "         ,dtausr     = " & AQ(gUser) & vbCrLf
    sSQL = sSQL & "     WHERE tran_id = " & AQ(s_EntryId) & vbCrLf
    sSQL = sSQL & " END "
    
    
    SQLSaveTrn = sSQL
    
MP vbDefault
Exit Function
errhndl:
    ErrMsg

End Function

Private Function SQLSaveDet(s_EntryId As String) As String
On Error GoTo errhndl
MP vbHourglass
    
    Dim sSQL As String
    Dim iCnt As Integer
    
    With mshTicket
        For iCnt = 0 To .Rows - 1
        
            sSQL = sSQL & " IF NOT EXISTS (" & vbCrLf
            sSQL = sSQL & "     SELECT '1' " & vbCrLf
            sSQL = sSQL & "     FROM TerSaldet " & vbCrLf
            sSQL = sSQL & "     WHERE tran_id = " & AQ(s_EntryId) & vbCrLf
            sSQL = sSQL & "     AND itm_code = " & Val(.TextMatrix(iCnt, enmColTicket.eItmId)) & vbCrLf
            sSQL = sSQL & "     )" & vbCrLf
            
            sSQL = sSQL & " BEGIN " & vbCrLf
            sSQL = sSQL & "     Insert into TerSaldet(" & vbCrLf
            sSQL = sSQL & "          tran_id" & vbCrLf
            sSQL = sSQL & "         ,tran_seq" & vbCrLf
            sSQL = sSQL & "         ,itm_code" & vbCrLf
            
            sSQL = sSQL & "         ,rtl_prc" & vbCrLf
            sSQL = sSQL & "         ,disc_amt" & vbCrLf
            sSQL = sSQL & "         ,qty" & vbCrLf
            sSQL = sSQL & "         ,amt" & vbCrLf
            
            sSQL = sSQL & "         ,dtadat" & vbCrLf
            sSQL = sSQL & "         ,dtatim" & vbCrLf
            sSQL = sSQL & "         ,dtausr" & vbCrLf
            
            sSQL = sSQL & "     ) Values (" & vbCrLf
            
            sSQL = sSQL & "          " & AQ(s_EntryId) & vbCrLf
            sSQL = sSQL & "         ," & iCnt + 1 & vbCrLf
            sSQL = sSQL & "         ," & Val(.TextMatrix(iCnt, enmColTicket.eItmId)) & vbCrLf
            
            sSQL = sSQL & "         ," & Val(.TextMatrix(iCnt, enmColTicket.eItmRtlPrc)) & vbCrLf
            sSQL = sSQL & "         ," & Val(.TextMatrix(iCnt, enmColTicket.eItmDistAmt)) & vbCrLf
            sSQL = sSQL & "         ," & Val(.TextMatrix(iCnt, enmColTicket.eItmQty)) & vbCrLf
            sSQL = sSQL & "         ," & Val(.TextMatrix(iCnt, enmColTicket.eItmamt)) & vbCrLf
            
            sSQL = sSQL & "         ," & ConvDatSql(Date) & vbCrLf
            sSQL = sSQL & "         ," & AQ(DtaTime) & vbCrLf
            sSQL = sSQL & "         ," & AQ(gUser) & vbCrLf
            sSQL = sSQL & ")" & vbCrLf
            sSQL = sSQL & " END " & vbCrLf
            
            sSQL = sSQL & " ELSE " & vbCrLf
            
            sSQL = sSQL & " BEGIN " & vbCrLf
            sSQL = sSQL & "     Update TerSaldet " & vbCrLf
            sSQL = sSQL & "     Set  tran_id = " & AQ(s_EntryId) & vbCrLf
            sSQL = sSQL & "         ,tran_seq = " & iCnt + 1 & vbCrLf
            sSQL = sSQL & "         ,itm_code = " & Val(.TextMatrix(iCnt, enmColTicket.eItmId)) & vbCrLf
            
            sSQL = sSQL & "         ,rtl_prc = " & Val(.TextMatrix(iCnt, enmColTicket.eItmRtlPrc)) & vbCrLf
            sSQL = sSQL & "         ,disc_amt = " & Val(.TextMatrix(iCnt, enmColTicket.eItmDistAmt)) & vbCrLf
            sSQL = sSQL & "         ,qty = " & Val(.TextMatrix(iCnt, enmColTicket.eItmQty)) & vbCrLf
            sSQL = sSQL & "         ,amt = " & Val(.TextMatrix(iCnt, enmColTicket.eItmamt)) & vbCrLf
            
            sSQL = sSQL & "         ,dtadat = " & ConvDatSql(Date) & vbCrLf
            sSQL = sSQL & "         ,dtatim = " & AQ(DtaTime) & vbCrLf
            sSQL = sSQL & "         ,dtausr = " & AQ(gUser) & vbCrLf
            
            sSQL = sSQL & "     where tran_id = " & AQ(s_EntryId) & vbCrLf
            sSQL = sSQL & "     and itm_code = " & Val(.TextMatrix(iCnt, enmColTicket.eItmId)) & vbCrLf
            
            sSQL = sSQL & " END " & vbCrLf
        Next
    End With
    SQLSaveDet = sSQL
    
MP vbDefault
Exit Function
errhndl:
    ErrMsg

End Function

Private Sub SaveSales()
On Error GoTo errhndl
MP vbHourglass

    Dim sEntryId As String
    Dim str_dt As String
    
    str_dt = GetYYMMDD(Date)
    
    gCnnMst.BeginTrans
    
        sEntryId = GetNewSalesTranId(str_dt)
    
        SQL = ""
        SQL = SQLSaveTrn(sEntryId) & vbCrLf
        SQL = SQL & SQLSaveDet(sEntryId) & vbCrLf
        gCnnMst.Execute SQL
        
        InsertUpdateBillSequence eUpdate, str_dt
    
    gCnnMst.CommitTrans
    
    TicketPrintPreview sEntryId

MP vbDefault
Exit Sub
errhndl:
    gCnnMst.RollbackTrans
    ErrMsg
End Sub

Private Function GetNewSalesTranId(s_strdt As String) As String

On Error GoTo errhndl
MP vbHourglass

    Dim strtmp As String
    
    Dim rsttmp As ADODB.Recordset
    Set rsttmp = New ADODB.Recordset
    
    SQL = " Select IsNull(seq,0) + 1 "
    SQL = SQL & " From BillSequence "
    SQL = SQL & " Where dtadat = " & AQ(s_strdt)
    SQL = SQL & " and ter_id = " & mTerminalId
    
    rsttmp.Open SQL, gCnnMst
    
    If rsttmp.RecordCount <= 0 Then
        InsertUpdateBillSequence eInsert, s_strdt
        strtmp = 1
    Else
        strtmp = rsttmp.Fields(0).Value
    End If
    
    GetNewSalesTranId = Trim$(s_strdt) & _
                        mTerminalId & _
                        Format(strtmp, "0000")
                        
    
    Set rsttmp = Nothing
    
MP vbDefault
Exit Function
errhndl:
    ErrMsg
End Function

Private Function GetYYMMDD(s_Date As Date) As String
    
    GetYYMMDD = Format(Right(Year(s_Date), 2), "00") & _
                Format(Month(s_Date), "00") & _
                Format(Day(s_Date), "00")
    
End Function


Private Sub InsertUpdateBillSequence(s_InsertUpdate As enmEntry, s_strdt As String)
    
    If s_InsertUpdate = eInsert Then
        SQL = "Insert Into BillSequence ( " & vbCrLf
        SQL = SQL & " dtadat"
        SQL = SQL & ",ter_id"
        SQL = SQL & ",seq"
        SQL = SQL & " ) Values ( "
        SQL = SQL & AQ(s_strdt)
        SQL = SQL & "," & mTerminalId
        SQL = SQL & ",1"
        SQL = SQL & ")"
    
    ElseIf s_InsertUpdate = eUpdate Then
        SQL = "Update BillSequence  " & vbCrLf
        SQL = SQL & " Set   seq = Isnull(seq,0)+1" & vbCrLf
        SQL = SQL & " Where dtadat = " & AQ(s_strdt) & vbCrLf
        SQL = SQL & " and ter_id = " & mTerminalId
    End If
    
    gCnnMst.Execute SQL

End Sub

Private Sub mshTicket_Scroll()
    mshHeader.LeftCol = mshTicket.LeftCol
End Sub


